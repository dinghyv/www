<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>数据转换工具</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      background-color: #f0f4f8;
      color: #333;
      padding: 20px;
      line-height: 1.6;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    h1 {
      color: #1a202c;
      text-align: center;
      margin-bottom: 0;
    }
    p {
      text-align: center;
      color: #4a5568;
    }
    textarea {
      width: 100%;
      height: 200px;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #e2e8f0;
      font-family: monospace;
      font-size: 14px;
      resize: vertical;
      background-color: #f7fafc;
    }
    button {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      background-color: #4a90e2;
      color: #fff;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.1s ease;
    }
    button:hover {
      background-color: #357bd8;
    }
    button:active {
      transform: scale(0.98);
    }
    .output-section {
      background-color: #f7fafc;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 15px;
    }
    .label {
      font-weight: bold;
      color: #4a5568;
      display: block;
      margin-bottom: 5px;
    }
    pre {
      white-space: pre-wrap;
      word-wrap: break-word;
      font-size: 14px;
      overflow-x: auto;
      margin: 0;
    }
    .error-message {
      color: #e53e3e;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>数据转换工具</h1>
  <p>请在下方文本框中输入您的原始数据。</p>
  
  <textarea id="input-data" placeholder="在此处粘贴您的数据..."></textarea>
  <button id="process-button">转换数据</button>
  
  <div class="output-section">
    <span class="label">转换后数据：</span>
    <pre id="output-data">等待输入...</pre>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const inputDataElement = document.getElementById('input-data');
  const processButton = document.getElementById('process-button');
  const outputDataElement = document.getElementById('output-data');

  /**
   * 使用正则表达式处理并转换原始数据。
   * 该函数专门用于从指定格式中提取键和坐标。
   * @param {string} rawData 原始文本数据。
   * @returns {string} 格式化后的JSON字符串或错误信息。
   */
  function processAndTransform(rawData) {
    // 移除所有非标准空白字符，并修剪首尾空白
    let cleanedData = rawData.replace(/\u00A0/g, ' ').trim();
    if (!cleanedData) {
      return "请输入数据。";
    }

    // 正则表达式来匹配键名和其对应的数组内容
    const keyArrayRegex = /"([^"]+)":\s*\[([\s\S]*?)\]\s*[,]?\s*$/;
    const match = cleanedData.match(keyArrayRegex);

    if (!match) {
      throw new Error("无效的数据格式，请确保输入包含一个键和其对应的数组。");
    }

    const key = match[1];
    const arrayContent = match[2];

    // 正则表达式来匹配数组中的坐标对
    const coordinateRegex = /\[\s*([0-9.-]+),\s*([0-9.-]+)/g;
    let coordinates = [];
    let result;
    while ((result = coordinateRegex.exec(arrayContent)) !== null) {
      const x = parseFloat(result[1]);
      const y = parseFloat(result[2]);
      coordinates.push({ "x": x, "y": y });
    }

    if (coordinates.length === 0) {
      throw new Error("在输入数据中未找到任何有效的坐标对。");
    }

    // 格式化输出为指定格式
    const formattedOutput = `"${key}": [\n${coordinates.map(item => `  ${JSON.stringify(item)}`).join(",\n")}\n]`;
    return formattedOutput;
  }

  // 按钮点击事件处理
  processButton.addEventListener('click', () => {
    const rawInput = inputDataElement.value;

    try {
      const formattedOutput = processAndTransform(rawInput);
      outputDataElement.textContent = formattedOutput;
      outputDataElement.style.color = '#333';
    } catch (e) {
      outputDataElement.textContent = e.message;
      outputDataElement.style.color = '#e53e3e';
    }
  });
});
</script>

</body>
</html>
